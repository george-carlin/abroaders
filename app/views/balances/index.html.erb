<div class='hpanel'>
  <div class="panel-heading hbuilt">
    <h1>
      Balances

      <% if @people.size == 1 %>
        <%= link_to(
          'Add new',
          new_person_balance_path(@people.first),
          class: 'btn btn-primary btn-sm',
          style: 'float: right; margin-bottom: 6px;',
        ) %>
      <% end %>
    </h1>
  </div>

  <% @people.each do |person| %>
    <div class="person_balances panel-body">
      <% if @people.size > 1 %>
        <h2><%= person.first_name %>'s balances</h2>

        <%= link_to "Add new balance for #{person.first_name}", new_person_balance_path(person) %>
      <% end %>

      <% person.balances.each do |balance| %>
        <%= form_for balance, data: { remote: true } do |f| %>
          <div id="<%= dom_id(balance) %>" class="<%= dom_class(balance) %> row">
            <div style="float:right;">
              <button
                class="edit_balance_btn btn btn-sm btn-primary"
                data-balance-id="<%= balance.id %>"
              >
                Edit
              </button>
              <%= link_to(
                'Delete',
                balance_path(balance),
                class: 'destroy_balance_btn btn btn-sm btn-primary',
                data: {
                  confirm: 'Are you sure? You can not undo this action',
                },
                method: :delete,
              ) %>
            </div>

            <div class="col-xs-12 col-md-4">
              <%= balance.currency_name %>
            </div>
            <div class="col-xs-6 col-md-5">
              <span class="balance_value">
                <%= cell(Balance::Cell::Value, balance) %>
              </span>

              <%= f.number_field(
                :value,
                class: "balance_value_editing",
                style: "display: none; height: 30px;"
              ) %>
            </div>

            <div class="col-xs-6 col-md-3">

              <%= cell(Balance::Cell::Index::Balance::Buttons, balance) %>

              <span class="editing_balance_error_msg" style="display:none;">
                Invalid value
              </span>

              <div class="LoadingSpinner" style="float: right; top: 13px; right: 22px; display:none;" ></div>
            </div>
          </div><!-- #dom_id(balance) -->

          <hr />
        <% end # form_for %>
      <% end # person.balances.each %>
    </div><!-- .person_balances.panel-body -->
 <% end # people.each %>
</div>
