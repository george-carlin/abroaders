<% provide :title, "Accounts" %>

<% content_for :header_panel do %>
  <div class="panel-body">
    <h1>User accounts</h1>
  </div>
<% end %>

<%= render "shared/hpanel" do  %>
  <div class="panel-body">
    <div class="form-group col-xs-12 col-md-8">
      <input
        id="admin_accounts_table_filter"
        type="text"
        class="form-control"
        placeholder="Filter by name or email..."
        />
    </div>

    <div class="form-inline">
      <div class="form-group col-xs-12 col-md-4">

        <div class="radio">
          <label>
            <input
              checked
              name="admin_accounts_filter_onboarded"
              type="radio"
              value="all"
            />
            All
          </label>
        </div>

        <div class="radio">
          <label>
            <input
              name="admin_accounts_filter_onboarded"
              type="radio"
              value="onboarded"
            />
            Onboarded
          </label>
        </div>

        <div class="radio">
          <label>
            <input
              name="admin_accounts_filter_onboarded"
              type="radio"
              value="not_onboarded"
            />
            Not onboarded
          </label>
        </div>

      </div>
    </div>

    <table
      id="admin_accounts_table"
      class="accounts table table-striped"
      cellpadding="1"
      cellspacing="1"
    >
      <thead>
        <tr>
          <th>O?</th>
          <th class="sortable-column-header" >
            Email
            &nbsp;
            <!-- <i class={class} style={style} > </i> -->
          </th>
          <th class="sortable-column-header" >
            Name
            &nbsp;
            <!-- <i class={class} style={style} > </i> -->
          </th>
          <th class="sortable-column-header">
            Companion
            &nbsp;
            <!-- <i class={class} style={style} > </i> -->
          </th>
          <th class="sortable-column-header" >
            Signed up
            &nbsp;
            <!-- <i class={class} style={style} > </i> -->
          </th>
          <th class="sortable-column-header" >
            Last rec
            &nbsp;
            <!-- <i class={class} style={style} > </i> -->
          </th>
          <!-- <th colspan="2"></th> -->
        </tr>
      </thead>
      <tbody id="admin_accounts_table_body">
        <% @accounts.each do |account| %>
          <tr
            id="<%= dom_id(account) %>"
            class="<%= dom_class(account) %>"
            data-companion-name="<%= account.companion&.first_name %>"
            data-email="<%= account.email %>"
            data-main-passenger-name="<%= account.main_passenger.first_name %>"
            data-onboarded="<%= account.onboarded? %>"
          >
            <td>
              <% if account.onboarded? %>
                <i class="fa fa-check"> </i>
              <% end %>
            </td>
            <td><%= account.email %></td>
            <td>
              <%= render(
                "admin_area/people/table_cell",
                person: account.main_passenger
              ) %>
            </td>
            <td>
              <% if account.companion.present? %>
                <%= render(
                  "admin_area/people/table_cell",
                  person: account.companion
                ) %>
              <% else %>
                -
              <% end %>
            </td>
            <td><%= account.created_at.strftime("%D") %></td>
            <td><%= account.last_recommendation_at.try(:strftime, "%D") || "-" %></td>
            <!-- <td><%= link_to "Info", admin_account_path(account) %></td> -->
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
