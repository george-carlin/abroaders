<% provide :title, "Offers" %>

<% content_for :header_panel do %>
  <div class="panel-body">
    <% if @card.present? %>
      <% present @card do |card| %>
        <h1><%= card.full_name(with_bank: true) %> - Card Offers</h1>
      <% end %>

      <p>
        <%= link_to "Add a new offer for this card", new_admin_card_offer_path(@card) %>
      </p>
    <% else %>
      <h1>All Card Offers</h1>

      <p>
        To add a new offer, find the card on the
        <%= link_to "cards page", admin_cards_path %> and click 'New Offer'
      </p>

      <p>
        Click on a card's name below to see all existing offers for that card.
      </p>
    <% end %>
  </div>
<% end %>

<%= render "shared/hpanel" do %>
  <div class="panel-body">
    <div class="table-responsive">
      <table
        class="table table-striped"
        cellpadding="1"
        cellspacing="1"
      >
        <thead>
          <tr>
            <th>ID</th>
            <th>Card</th>
            <th>Bank</th>
            <th>Points awarded</th>
            <th>Spend</th>
            <th>Cost</th>
            <th>Days</th>
            <th>Live</th>
            <th></th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <% present_each @offers do |offer| %>
            <tr id="<%= dom_id(offer) %>" class="<%= dom_class(offer) %>">
              <td><%= offer.identifier(with_card: true) %></td>
              <td><%= link_to offer.card_name, admin_card_offers_path(offer.card) %></td>
              <td><%= offer.bank_name %></td>
              <td><%= offer.points_awarded %></td>
              <td><%= offer.spend %></td>
              <td><%= offer.cost %></td>
              <td><%= offer.days %></td>
              <td><%= offer.live ? "Yes" : "No" %></td>
              <td><%= link_to 'Show', admin_offer_path(offer) %></td>
              <td><%= link_to 'Edit', edit_admin_offer_path(offer) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% end %>
