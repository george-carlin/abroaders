<% provide :title, "Edit Card" %>

<div class="hpanel">
  <div class="panel-heading hbuilt">
    <div class="row">
      <div class="col-xs-12">
        <h1>Edit Card</h1>
      </div>
    </div><!-- .row -->
  </div>

  <%= render 'shared/model_validation_errors', model: @form %>

  <div class="panel-body">
    <%= form_for @form, url: card_path(@model), html: { class: "edit_card" } do |f| %>

      <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-2">
          <%= CardProduct::Cell::Image.(@model.product, size: '130x81') %>
        </div>

        <div class="col-xs-12 col-sm-6 col-md-4">
          <p>
            <span class="card-account-card-name">
              <%= @model.product.name %>
              <% unless @model.product.unknown_network? %>
                (<%= @model.product.network %>)
              <% end %>
            </span>
          </p>

          <p>
            <span class="card-account-bank">
              <%= @model.product.bank_name %>
            </span>
          </p>
        </div>

        <div class="col-xs-12 col-md-6">
          <div class="row">
            <div class="col-md-12 col-lg-4">
              <label class="card-info-label">When did you open this card?</label>
            </div>

            <div class="col-md-12 col-lg-8">
              <%= f.date_select(
                :opened_at,
                end_year:   Date.today.year,
                order:      [:month, :year],
                start_year: Date.today.year - 10,
                use_short_month: true,
                discard_day: true,
              ) %>
            </div>

            <div class="col-md-12 col-lg-4">
              <%= f.label :closed, class: 'card-info-label' do %>
                Is this account now closed?
              <% end %>
            </div>

            <div class="col-md-12 col-lg-8">
              <%= f.check_box :closed, class: "cards_survey_card_closed input-lg" %>
            </div>

            <div class="card-survey-closed <%= 'hide' unless @form.closed %>">
              <div class="col-md-12 col-lg-4">
                <label class="card-info-label card-survey-closed">When did you close this card?</label>
              </div>

              <div class="col-md-12 col-lg-8">
                <%= f.date_select(
                    :closed_at,
                    end_year:   Date.today.year,
                    order:      [:month, :year],
                    start_year: Date.today.year - 10,
                    use_short_month: true,
                    discard_day: true,
                    class: "cards_survey_select"
                ) %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <hr>

      <div class="row">
        <div class="col-xs-12">
          <%= f.submit 'Save', class: 'btn btn-primary btn-lg' %>
        </div>
      </div>
    <% end %>
  </div>
</div>
